<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Nazar Optik</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    .edit-btn,
    .delete-btn {
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    .edit-btn,
    .delete-btn {
      cursor: pointer;
    }
  </style>
  <!-- Favicon -->
  <link href="img/favicon.ico" rel="icon">

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@500;700&display=swap"
    rel="stylesheet">

  <!-- Icon Font Stylesheet -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Libraries Stylesheet -->
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!-- Template Stylesheet -->
  <link href="css/style.css" rel="stylesheet">
</head>

<body>
  <div class="container-fluid position-relative d-flex p-0">
    <!-- Spinner Start -->
    <div id="spinner"
      class="show bg-dark position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="sr-only">Loading...</span>
      </div>
    </div>
    <div class="sidebar pe-4 pb-3">
      <nav class="navbar  navbar-dark">
        <a href="index.html" class="navbar-brand mx-4 mb-3">
          <h3 class=""><i class="fa fa-user-edit me-2"></i>Nazar Optik</h3>
        </a>
        <div class="d-flex align-items-center ms-4 mb-4">
          <div class="position-relative">
            <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px;">
            <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1">
            </div>
          </div>
          <div class="ms-3">
            <h6 class="mb-0">Yunus İbin</h6>
            <span>Admin</span>
          </div>
        </div>
        <div class="navbar-nav w-100">
          <a href="firm-identification.html" class="nav-item nav-link active mb-3"><i
                  class="fa fa-tachometer-alt me-2"></i>Firma Tanımları</a>
          <a href="brand-definitions.html" class="nav-item nav-link active mb-3"><i
                  class="fa fa-tachometer-alt me-2"></i>Marka Tanımları</a>
          <a href="index.html" class="nav-item nav-link active"><i
                  class="fa fa-tachometer-alt me-2"></i>Kullanıcılar</a>
          <a href="product-stock.html" class="nav-item nav-link active mt-3"><i
                  class="fa fa-tachometer-alt me-2"></i>Ürün Stoğu</a>
          <a href="https://optik.sgk.gov.tr/Optik_Firma_Web/login.jsp" class="nav-item nav-link active mt-3"><i
                  class="fa fa-tachometer-alt me-2"></i>Medula Giriş</a>
      </div>
      </nav>
    </div>
    <div class="content">
      <div class="container-fluid pl-4">
        <div class="pl-4">
          <div class="pb-4">
          <button id="myBtn" class="btn btn-primary">Firma Tanımla</button>
        </div>
          <div id="myModal" class="modal">
            <div class="modal-content">
              <span class="close">&times;</span>
              <h5 class="text-dark text-center pb-5">Firma Tanımlama Formu</h3>
              <form>
                <div class="d-flex">
                  <div class="form-group col-md-6">
                    <label for="firmaKodu">Firma Kodu:</label>
                    <input type="text" id="firmaKodu" class="input-type-style" required>
                  </div>
                  <div class="form-group col-md-6">
                    <label for="firmaAdi">Firma Adı:</label>
                    <input type="text" id="firmaAdi" class="input-type-style" required>
                  </div>
                </div>
                <div class="d-flex">
                  <div class="form-group col-md-6">
                    <label for="ulke">Ülke:</label>
                    <input type="text" id="ulke" class="input-type-style" required>
                  </div>
                  <div class="form-group col-md-6">
                    <label for="alisPara">Alış Para:</label>
                    <input type="text" id="alisPara" class="input-type-style" required>
                  </div>
                </div>
                <div class="d-flex">
                  <div class="form-group col-md-6">
                    <label for="satisPara">Satış Para:</label>
                    <input type="text" id="satisPara" class="input-type-style" required>
                  </div>
                  <div class="form-group col-md-6">
                    <label for="iskontoOrani">İskonto Oranı:</label>
                    <input type="text" id="iskontoOrani" class="input-type-style" required>
                  </div>
                </div>
                <div class="col-md-12 d-flex justify-content-center pt-4"> <button  id="submitBtn"
                  class="modal-butons">Kaydet</button></div>
              </form>
            </div>
          </div>

          <table id="firmaTable" class="table">
            <thead>
              <tr>
                <th>Firma Kodu</th>
                <th>Firma Adı</th>
                <th>Ülke</th>
                <th>Alış Para</th>
                <th>Satış Para</th>
                <th>İskonto Oranı</th>
                <th>İşlemler</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
        <!-- Footer End -->
      </div>
    </div>
    <!-- Content End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
  </div>

  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var modal = document.getElementById('myModal');
      var btn = document.getElementById('myBtn');
      var span = document.getElementsByClassName('close')[0];
      var submitBtn = document.getElementById('submitBtn');
      var editRow = null; // Düzenleme yapılacak satırın referansını tutar

      btn.onclick = function () {
        modal.style.display = 'block';
      }

      span.onclick = function () {
        modal.style.display = 'none';
        resetForm(); // Formu sıfırla
      }

      submitBtn.onclick = function () {
        var firmaKodu = document.getElementById('firmaKodu').value;
        var firmaAdi = document.getElementById('firmaAdi').value;
        var ulke = document.getElementById('ulke').value;
        var alisPara = document.getElementById('alisPara').value;
        var satisPara = document.getElementById('satisPara').value;
        var iskontoOrani = document.getElementById('iskontoOrani').value;

        if (editRow) {
          // Düzenleme modunda ise, satırı güncelle
          editRow.cells[0].innerHTML = firmaKodu;
          editRow.cells[1].innerHTML = firmaAdi;
          editRow.cells[2].innerHTML = ulke;
          editRow.cells[3].innerHTML = alisPara;
          editRow.cells[4].innerHTML = satisPara;
          editRow.cells[5].innerHTML = iskontoOrani;
        } else {
          // Yeni firma ekleniyor
          var table = document.getElementById('firmaTable');
          var newRow = table.insertRow(table.rows.length);
          var cell1 = newRow.insertCell(0);
          var cell2 = newRow.insertCell(1);
          var cell3 = newRow.insertCell(2);
          var cell4 = newRow.insertCell(3);
          var cell5 = newRow.insertCell(4);
          var cell6 = newRow.insertCell(5);
          var cell7 = newRow.insertCell(6);
          cell1.innerHTML = firmaKodu;
          cell2.innerHTML = firmaAdi;
          cell3.innerHTML = ulke;
          cell4.innerHTML = alisPara;
          cell5.innerHTML = satisPara;
          cell6.innerHTML = iskontoOrani;
          cell7.innerHTML = '<i class="fas fa-edit edit-btn"></i> <i class="fas fa-trash-alt delete-btn"></i>';

          // Verileri localStorage'e kaydet
          saveDataToLocalStorage();
        }

        modal.style.display = 'none';
        resetForm(); // Formu sıfırla
      }

      // Düzenleme işlemi için düzenle butonlarını dinleyin
      document.addEventListener('click', function (e) {
        if (e.target && e.target.classList.contains('edit-btn')) {
          var row = e.target.parentNode.parentNode;
          var cells = row.getElementsByTagName('td');
          var firmaKodu = cells[0].innerHTML;
          var firmaAdi = cells[1].innerHTML;
          var ulke = cells[2].innerHTML;
          var alisPara = cells[3].innerHTML;
          var satisPara = cells[4].innerHTML;
          var iskontoOrani = cells[5].innerHTML;

          // Formu doldur
          document.getElementById('firmaKodu').value = firmaKodu;
          document.getElementById('firmaAdi').value = firmaAdi;
          document.getElementById('ulke').value = ulke;
          document.getElementById('alisPara').value = alisPara;
          document.getElementById('satisPara').value = satisPara;
          document.getElementById('iskontoOrani').value = iskontoOrani;

          editRow = row; // Düzenleme yapılacak satırın referansını kaydet

          modal.style.display = 'block';
        }
      });

      // Silme işlemi için sil butonlarını dinleyin
      document.addEventListener('click', function (e) {
        if (e.target && e.target.classList.contains('delete-btn')) {
          var row = e.target.parentNode.parentNode;
          row.parentNode.removeChild(row);

          // Verileri localStorage'den güncelle
          saveDataToLocalStorage();
        }
      });

      // Sayfa yüklendiğinde verileri localStorage'den geri yükle
      loadDataFromLocalStorage();

      // Formu sıfırlamak için işlev
      function resetForm() {
        editRow = null;
        document.getElementById('firmaKodu').value = '';
        document.getElementById('firmaAdi').value = '';
        document.getElementById('ulke').value = '';
        document.getElementById('alisPara').value = '';
        document.getElementById('satisPara').value = '';
        document.getElementById('iskontoOrani').value = '';
      }

      // Verileri localStorage'e kaydetmek için işlev
      function saveDataToLocalStorage() {
        var tableData = [];
        var tableRows = document.querySelectorAll('#firmaTable tbody tr');

        tableRows.forEach(function (row) {
          var rowData = {
            firmaKodu: row.cells[0].innerHTML,
            firmaAdi: row.cells[1].innerHTML,
            ulke: row.cells[2].innerHTML,
            alisPara: row.cells[3].innerHTML,
            satisPara: row.cells[4].innerHTML,
            iskontoOrani: row.cells[5].innerHTML
          };

          tableData.push(rowData);
        });

        localStorage.setItem('firmaTableData', JSON.stringify(tableData));
      }

      // Verileri localStorage'den geri yüklemek için işlev
      function loadDataFromLocalStorage() {
        var tableData = JSON.parse(localStorage.getItem('firmaTableData'));

        if (tableData) {
          var table = document.getElementById('firmaTable');
          var tbody = table.querySelector('tbody');

          tableData.forEach(function (rowData) {
            var newRow = tbody.insertRow();
            newRow.insertCell().innerHTML = rowData.firmaKodu;
            newRow.insertCell().innerHTML = rowData.firmaAdi;
            newRow.insertCell().innerHTML = rowData.ulke;
            newRow.insertCell().innerHTML = rowData.alisPara;
            newRow.insertCell().innerHTML = rowData.satisPara;
            newRow.insertCell().innerHTML = rowData.iskontoOrani;
            newRow.insertCell().innerHTML = '<i class="fas fa-edit edit-btn"></i> <i class="fas fa-trash-alt delete-btn"></i>';
          });
        }
      }

    });
  </script>
  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/chart/chart.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="lib/tempusdominus/js/moment.min.js"></script>
  <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
  <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>
</body>

</html>