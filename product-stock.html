<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Nazar Optik</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
      .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }
  
      .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
      }
  
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }
  
      .close:hover,
      .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
      }
  
      .edit-btn,
      .delete-btn {
        cursor: pointer;
      }
  
      .total-stok {
        font-weight: bold;
      }
    </style>
    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@500;700&display=swap"
        rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <div class="container-fluid position-relative d-flex p-0">
        <!-- Spinner Start -->
        <div id="spinner"
            class="show bg-dark position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <div class="sidebar pe-4 pb-3">
            <nav class="navbar  navbar-dark">
                <a href="index.html" class="navbar-brand mx-4 mb-3">
                    <h3 class=""><i class="fa fa-user-edit me-2"></i>Nazar Optik</h3>
                </a>
                <div class="d-flex align-items-center ms-4 mb-4">
                    <div class="position-relative">
                        <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px;">
                        <div
                            class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1">
                        </div>
                    </div>
                    <div class="ms-3">
                        <h6 class="mb-0">Yunus İbin</h6>
                        <span>Admin</span>
                    </div>
                </div>
                <div class="navbar-nav w-100">
                  <a href="firm-identification.html" class="nav-item nav-link active mb-3"><i
                          class="fa fa-tachometer-alt me-2"></i>Firma Tanımları</a>
                          <a href="brand-definitions.html" class="nav-item nav-link active mb-3"><i
                              class="fa fa-tachometer-alt me-2"></i>Marka Tanımları</a>
                  <a href="index.html" class="nav-item nav-link active"><i
                          class="fa fa-tachometer-alt me-2"></i>Kullanıcılar</a>
                  <a href="product-stock.html" class="nav-item nav-link active mt-3"><i
                          class="fa fa-tachometer-alt me-2"></i>Ürün Stoğu</a>
              </div>
            </nav>
        </div>
        <div class="content">
            <div class="container-fluid pt-4 p-4">
              <div class="p-4">
              <button id="myBtn" class="btn btn-primary">Ürün Ekle</button>

              <div id="myModal" class="modal">
                <div class="modal-content">
                  <span class="close">&times;</span>
                  <h3>Ürün Bilgileri</h3>
                  <form>
                    <div class="form-group">
                      <label for="barkod">Barkod:</label>
                      <input type="text" id="barkod" class="input-type-style" required>
                    </div>
            
                    <div class="form-group">
                      <label for="urunAdi">Ürün Adı:</label>
                      <input type="text" id="urunAdi" class="input-type-style" required>
                    </div>
            
                    <div class="form-group">
                      <label for="gelenFiyat">Geliş Fiyatı:</label>
                      <input type="text" id="gelenFiyat" class="input-type-style" required>
                    </div>
            
                    <div class="form-group">
                      <label for="satisFiyat">Satış Fiyatı:</label>
                      <input type="text" id="satisFiyat" class="input-type-style" required>
                    </div>
                    
                    <div class="form-group">
                      <label for="stokAdedi">Stok Adedi:</label>
                      <input type="number" id="stokAdedi" class="input-type-style" required>
                    </div>
            
                    <button type="button" id="submitBtn" class="btn btn-primary">Kaydet</button>
                  </form>
                </div>
              </div>
            
              <table id="stokTable" class="table">
                <thead>
                  <tr>
                    <th>Barkod</th>
                    <th>Ürün Adı</th>
                    <th>Geliş Fiyatı</th>
                    <th>Satış Fiyatı</th>
                    <th>Stok Adedi</th>
                    <th>İşlemler</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                  <tr>
                    <th colspan="4">Toplam Stok Adedi:</th>
                    <th class="total-stok"></th>
                    <th></th>
                  </tr>
                </tfoot>
              </table>
            </div>
            <!-- Footer End -->
            </div>
        </div>
        <!-- Content End -->


        <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var modal = document.getElementById('myModal');
      var btn = document.getElementById('myBtn');
      var span = document.getElementsByClassName('close')[0];
      var submitBtn = document.getElementById('submitBtn');
      var editRow = null; // Düzenleme yapılacak satırın referansını tutar

      btn.onclick = function() {
        modal.style.display = 'block';
      }

      span.onclick = function() {
        modal.style.display = 'none';
        resetForm(); // Formu sıfırla
      }

      submitBtn.onclick = function() {
        var barkod = document.getElementById('barkod').value;
        var urunAdi = document.getElementById('urunAdi').value;
        var gelenFiyat = document.getElementById('gelenFiyat').value;
        var satisFiyat = document.getElementById('satisFiyat').value;
        var stokAdedi = document.getElementById('stokAdedi').value;

        if (editRow) {
          // Düzenleme modunda ise, satırı güncelle
          editRow.cells[0].innerHTML = barkod;
          editRow.cells[1].innerHTML = urunAdi;
          editRow.cells[2].innerHTML = gelenFiyat;
          editRow.cells[3].innerHTML = satisFiyat;
          editRow.cells[4].innerHTML = stokAdedi;
        } else {
          // Yeni ürün ekleniyor
          var table = document.getElementById('stokTable');
          var newRow = table.insertRow(table.rows.length - 1); // Son sıradaki toplam satırını önce ekle
          var cell1 = newRow.insertCell(0);
          var cell2 = newRow.insertCell(1);
          var cell3 = newRow.insertCell(2);
          var cell4 = newRow.insertCell(3);
          var cell5 = newRow.insertCell(4);
          var cell6 = newRow.insertCell(5);
          cell1.innerHTML = barkod;
          cell2.innerHTML = urunAdi;
          cell3.innerHTML = gelenFiyat;
          cell4.innerHTML = satisFiyat;
          cell5.innerHTML = stokAdedi;
          cell6.innerHTML = '<i class="fas fa-edit edit-btn"></i> <i class="fas fa-trash-alt delete-btn"></i>';
        }

        modal.style.display = 'none';
        resetForm(); // Formu sıfırla
        calculateTotalStok();
      }

      // Düzenleme işlemi için düzenle butonlarını dinle
      document.addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('edit-btn')) {
          var row = e.target.parentNode.parentNode;
          var cells = row.getElementsByTagName('td');
          var barkod = cells[0].innerHTML;
          var urunAdi = cells[1].innerHTML;
          var gelenFiyat = cells[2].innerHTML;
          var satisFiyat = cells[3].innerHTML;
          var stokAdedi = cells[4].innerHTML;

          // Formu doldur
          document.getElementById('barkod').value = barkod;
          document.getElementById('urunAdi').value = urunAdi;
          document.getElementById('gelenFiyat').value = gelenFiyat;
          document.getElementById('satisFiyat').value = satisFiyat;
          document.getElementById('stokAdedi').value = stokAdedi;

          editRow = row; // Düzenleme yapılacak satırın referansını kaydet

          modal.style.display = 'block';
        }
      });

      // Silme işlemi için sil butonlarını dinle
      document.addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('delete-btn')) {
          var row = e.target.parentNode.parentNode;
          row.parentNode.removeChild(row);
          calculateTotalStok();
        }
      });

      // Formu sıfırlamak için işlev
      function resetForm() {
        editRow = null;
        document.getElementById('barkod').value = '';
        document.getElementById('urunAdi').value = '';
        document.getElementById('gelenFiyat').value = '';
        document.getElementById('satisFiyat').value = '';
        document.getElementById('stokAdedi').value = '';
      }

      // Toplam stok adedini hesapla ve tabloya ekle
      function calculateTotalStok() {
        var table = document.getElementById('stokTable');
        var totalStok = 0;

        for (var i = 1; i < table.rows.length - 1; i++) { // Toplam satırı hariç, başlık ve son satırı sayma
          var row = table.rows[i];
          var stokAdedi = parseInt(row.cells[4].innerHTML);
          if (!isNaN(stokAdedi)) {
            totalStok += stokAdedi;
          }
        }

        var totalRow = table.rows[table.rows.length - 1];
        var totalCell = totalRow.cells[4];
        totalCell.innerHTML = '<span class="total-stok">' + totalStok + '</span>';
      }
    });
  </script>
    <!-- JavaScript Libraries -->
    <script src="js/index.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/chart/chart.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>